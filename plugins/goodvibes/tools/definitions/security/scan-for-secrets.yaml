name: scan_for_secrets
version: "1.0.0"
description: |
  Scan source files for potential secrets, credentials, and sensitive data.
  Detects common secret patterns including API keys, tokens, passwords,
  private keys, and database connection strings.

mcp:
  server: goodvibes-tools
  method: scan_for_secrets
  defer_loading: true

input_schema:
  type: object
  properties:
    path:
      type: string
      description: "Directory to scan for secrets"
      default: "."
    include_staged:
      type: boolean
      description: "Also check git staged files"
      default: true
    severity_threshold:
      type: string
      enum: ["low", "medium", "high"]
      description: "Minimum severity level to report"
      default: "low"
  required: []

output_schema:
  type: object
  properties:
    findings:
      type: array
      items:
        type: object
        properties:
          file: { type: string, description: "File path where secret was found" }
          line: { type: integer, description: "Line number" }
          column: { type: integer, description: "Column position" }
          secret_type: { type: string, description: "Type of secret detected" }
          severity: { type: string, enum: ["low", "medium", "high"] }
          preview: { type: string, description: "Redacted preview of the match" }
          recommendation: { type: string, description: "How to fix the issue" }
    count:
      type: integer
      description: "Total number of findings"
    by_severity:
      type: object
      properties:
        high: { type: integer }
        medium: { type: integer }
        low: { type: integer }

examples:
  - description: "Scan current directory for secrets"
    input:
      path: "."
      include_staged: true
    output:
      findings:
        - file: "src/config.ts"
          line: 15
          column: 20
          secret_type: "aws_access_key"
          severity: "high"
          preview: "AKIA***************"
          recommendation: "Use environment variables instead of hardcoding AWS credentials"
      count: 1
      by_severity:
        high: 1
        medium: 0
        low: 0
  - description: "Scan with high severity threshold only"
    input:
      path: "src"
      severity_threshold: "high"
    output:
      findings: []
      count: 0
      by_severity:
        high: 0
        medium: 0
        low: 0
